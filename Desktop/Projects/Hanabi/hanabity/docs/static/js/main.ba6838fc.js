(()=>{"use strict";var e={3415:(e,t,n)=>{n.r(t);var r=n(7404),o=n(9526),l=n(8592),i=n(319),a=n(3497),s=n(9233),c=n(1133),d=n(9997),u=n(477),f=n(6337),h=n(7557);function b({given_title:e,cards_to_show:t,changeStatus:n}){const[r,l]=(0,o.useState)(e),[i,a]=(0,o.useState)(t);function f(e){switch(e){case"Red":return"#FFDDDD";case"Green":return"#DDFFDD";case"Blue":return"#DDDDFF";case"Yellow":return"#FFFFDD";default:return"#EEEEEE"}}function b(e){switch(e){case"Red":return"#CCAAAA";case"Green":return"#AACCAA";case"Blue":return"#AAAACC";case"Yellow":return"#CCCCAA";default:return"#CCCCCC"}}return(0,o.useEffect)((()=>{a(t)}),[t]),(0,h.jsx)(u.default,{style:x.container,children:(0,h.jsxs)(c.default,{children:[(0,h.jsx)(s.default,{style:x.title,children:r}),Object.entries(i).map((([e,t])=>(0,h.jsxs)(c.default,{style:x.cardTypeContainer,children:[(0,h.jsx)(s.default,{style:x.subTitle,children:e}),(0,h.jsx)(c.default,{style:[x.deckContainer,{backgroundColor:f(e)}],children:t.map(((t,o)=>(0,h.jsx)(d.default,{onPress:()=>n(r,t,e),style:[x.cardBtn,{backgroundColor:b(e)}],children:(0,h.jsx)(s.default,{style:x.cardBtnText,numberOfLines:2,ellipsizeMode:"tail",children:t})},`${e}-${o}`)))})]},e))),(0,h.jsx)(c.default,{style:x.paddingBottom})]})})}const{height:m}=f.default.get("window"),x=l.default.create({container:{flex:1,height:.8*m},title:{fontSize:18,fontWeight:"bold",marginBottom:16},cardTypeContainer:{marginBottom:16},subTitle:{fontSize:14,fontWeight:"bold",marginTop:12,marginBottom:8},paddingBottom:{height:50},titleContainer:{flexDirection:"row",alignItems:"center",gap:8},stepContainer:{gap:8,marginBottom:8},deckContainer:{flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",gap:8,padding:5,borderRadius:4,borderWidth:4,borderColor:"#fff"},cardBtn:{width:20,height:20,borderRadius:8,justifyContent:"center",alignItems:"center",color:"#fff",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:3,elevation:3},cardBtnText:{fontSize:14,color:"#fff",textAlign:"center",maxWidth:"90%"}});var y=n(6245);function g({idx:e,color:t,number:n,probability:r,update:l,options:i,resetCard:a}){const[f,b]=(0,o.useState)(!1),[m,x]=(0,o.useState)(t||""),[g,C]=(0,o.useState)(n||""),[j,k]=(0,o.useState)(t||""),[w,v]=(0,o.useState)(n||"");return(0,o.useEffect)((()=>{x(t||""),C(n||""),k(t||""),v(n||"")}),[t,n]),(0,h.jsxs)(u.default,{style:p.cardContainer,children:[(0,h.jsxs)(s.default,{style:p.cardTitle,children:["Card ",e+1]}),(0,h.jsx)(c.default,{style:p.cardContent,children:f?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(c.default,{style:p.editSection,children:[(0,h.jsxs)(c.default,{style:p.pickerContainer,children:[(0,h.jsx)(s.default,{style:p.pickerLabel,children:"Color"}),(0,h.jsxs)(y.default,{selectedValue:j,style:p.picker,onValueChange:k,children:[(0,h.jsx)(y.default.Item,{label:"Select color",value:""}),i?.color?.map((e=>(0,h.jsx)(y.default.Item,{label:e,value:e},e)))]})]}),(0,h.jsxs)(c.default,{style:p.pickerContainer,children:[(0,h.jsx)(s.default,{style:p.pickerLabel,children:"Number"}),(0,h.jsxs)(y.default,{selectedValue:w,style:p.picker,onValueChange:v,children:[(0,h.jsx)(y.default.Item,{label:"Select number",value:""}),i?.number?.map((e=>(0,h.jsx)(y.default.Item,{label:String(e),value:String(e)},e)))]})]})]}),(0,h.jsxs)(c.default,{style:p.buttonRow,children:[(0,h.jsx)(d.default,{style:[p.actionButton,p.cancelButton],onPress:function(){k(m||""),v(g||""),b(!1)},children:(0,h.jsx)(s.default,{style:p.buttonText,children:"Cancel"})}),(0,h.jsx)(d.default,{style:[p.actionButton,p.saveButton],onPress:()=>function(e,t,n){l(e,t||"",n||""),x(t||""),C(n||""),b(!1)}(e,j,w),children:(0,h.jsx)(s.default,{style:p.buttonText,children:"Save"})})]})]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(c.default,{style:p.cardInfo,children:[(0,h.jsxs)(s.default,{style:p.cardText,children:["Likely Color: ",m||"Not determined"]}),(0,h.jsxs)(s.default,{style:p.cardText,children:["Likely Number: ",g||"Not determined"]}),(m||g)&&void 0!==r&&(0,h.jsxs)(s.default,{style:p.cardText,children:["Probability: ","number"===typeof r?r.toFixed(2)+"%":"N/A"]})]}),(0,h.jsxs)(c.default,{style:p.buttonRow,children:[(0,h.jsx)(d.default,{style:[p.actionButton,p.editButton],onPress:()=>b(!0),children:(0,h.jsx)(s.default,{style:p.buttonText,children:"Edit Card"})}),(0,h.jsx)(d.default,{style:[p.actionButton,p.resetButton],onPress:function(){a(e)},children:(0,h.jsx)(s.default,{style:p.buttonText,children:"Reset Card"})})]})]})})]})}const p=l.default.create({cardContainer:{backgroundColor:"#fff",borderRadius:10,padding:15,margin:10,width:250,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},cardTitle:{fontSize:18,fontWeight:"bold",marginBottom:10,color:"#333"},cardContent:{marginTop:5},cardInfo:{marginBottom:15},cardText:{fontSize:16,marginBottom:5,color:"#555"},buttonRow:{flexDirection:"row",justifyContent:"space-between",marginTop:10},actionButton:{padding:10,borderRadius:5,alignItems:"center",minWidth:100},editButton:{backgroundColor:"#4a90e2"},resetButton:{backgroundColor:"#ffaaaa",marginLeft:10},editSection:{marginBottom:15},pickerContainer:{marginBottom:15},pickerLabel:{fontSize:16,marginBottom:5,color:"#555"},picker:{height:50,width:"100%",backgroundColor:"#f5f5f5",borderRadius:5},cancelButton:{backgroundColor:"#e74c3c"},saveButton:{backgroundColor:"#2ecc71"},buttonText:{color:"white",fontWeight:"bold"}});function C({deck:e,options:t,cards_per_player:n}){const r=()=>Array(n).fill().map((()=>({likelyColor:"",likelyNumber:"",probability:0}))),l=()=>Array(n).fill().map((()=>({color:{value:"",fixed:!1},number:{value:"",fixed:!1}}))),[a,d]=(0,o.useState)(r()),[f,b]=(0,o.useState)(l()),[m,x]=(0,o.useState)([]),y=(0,o.useMemo)((()=>m.flat().reduce(((e,t)=>e+t),0)),[m]);(0,o.useEffect)((()=>{d(r()),b(l())}),[n]);const p=(e,t)=>{const n=[];let r=0;return t.color.forEach((o=>{const l=t.number.map((t=>{const n=(e[o]||[]).filter((e=>parseInt(e)===parseInt(t))).length;return r+=n,n}));n.push(l)})),[n,r]},C=e=>!e||0===Object.values(e).flat().length,k=(e,t,n)=>{console.log("Updating card knowledge for idx:",e),console.log("Color:",t,"Number:",n),console.log("Before update:",f[e]),((e,t,n,r,o)=>{let l=f[e],i=[...f];l.color={value:t,fixed:r},l.number={value:n.toString(),fixed:o},i[e]=l,b(i)})(e,t,n,!0,!0),console.log("After update:",f[e]);const r=[...a];r[e]={likelyColor:t,likelyNumber:n,probability:100},d(r),S()};function w(e){let t=[...f];t[e]={color:{value:"",fixed:!1},number:{value:"",fixed:!1}},b(t);const n=[...a];n[e]={likelyColor:"?",likelyNumber:"?",probability:0},d(n),S()}const v=(e,n)=>{const r=f[e];let o={likelyColor:"",likelyNumber:"",probability:0};if(r.color.fixed&&(o.likelyColor=r.color.value),r.number.fixed&&(o.likelyNumber=r.number.value),(!r.color.fixed||!r.number.fixed)&&y>1){const e=t.color.map(((e,t)=>({color:e,prob:n[t].reduce(((e,t)=>e+t),0)/y}))),l=t.number.map(((e,t)=>({number:e,prob:n.reduce(((e,n)=>e+n[t]),0)/y}))),i=e.reduce(((e,t)=>t.prob>e.prob?t:e),e[0]),a=l.reduce(((e,t)=>t.prob>e.prob?t:e),l[0]);if(i.prob>a.prob){if(r.color.fixed||(o.likelyColor=i.color),!r.number.fixed){const e=((e,n)=>{const r=t.color.indexOf(n);if(r<0||r>=e.length)return{number:"",probability:0};const o=e[r],l=o.indexOf(Math.max(...o));return{number:t.number[l]||"",probability:o[l]/y}})(n,o.likelyColor);o.likelyNumber=e.number}}else r.number.fixed||(o.likelyNumber=a.number),r.color.fixed||(o.likelyColor=((e,n)=>{const r=parseInt(n)-1;if(r<0||r>=t.number.length)return"";let o=0,l=0;for(let t=0;t<e.length;t++){const n=e[t][r]/y;n>l&&(l=n,o=t)}return t.color[o]||""})(n,o.likelyNumber));const s=t.color.indexOf(o.likelyColor),c=t.number.indexOf(o.likelyNumber);s>=0&&c>=0&&(o.probability=Math.round(n[s][c]/y*100))}return r.color.fixed&&r.number.fixed&&(o.probability=100),o},S=()=>{if(C(e))return;const[r]=p(e,t),o=r.map((e=>[...e]));f.forEach(((e,n)=>{if(e.color.fixed&&e.number.fixed){const n=parseInt(e.number.value)-1,r=t.color.indexOf(e.color.value);r>=0&&n>=0&&(o[r][n]=Math.max(0,o[r][n]-1))}}));const l=Array(n).fill().map(((e,t)=>t)),i=o.map((e=>[...e]));l.forEach((e=>{const n=f[e];if(n.color.fixed&&n.number.fixed)return;const r=i.map((e=>[...e]));if(a[e].likelyColor&&a[e].likelyNumber){const n=parseInt(a[e].likelyNumber)-1,o=t.color.indexOf(a[e].likelyColor);o>=0&&n>=0&&(r[o][n]=Math.max(0,r[o][n]-1))}const o=v(e,r);if(o.likelyColor&&o.likelyNumber){const e=parseInt(o.likelyNumber)-1,n=t.color.indexOf(o.likelyColor);n>=0&&e>=0&&(i[n][e]=Math.max(0,i[n][e]-1))}d((t=>{const n=[...t];return n[e]=o,n}))})),x(r)};return(0,o.useEffect)((()=>{if(C(e))return x([]),d(r()),void b(l());const[n]=p(e,t);x(n),S()}),[e,t,f,n]),(0,h.jsx)(u.default,{children:(0,h.jsxs)(c.default,{children:[(0,h.jsx)(s.default,{style:j.text,children:"Your Hand"}),(0,h.jsx)(c.default,{style:j.handContainer,children:(0,h.jsx)(i.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:j.scrollContent,children:a.map(((e,n)=>(0,h.jsx)(g,{idx:n,color:e.likelyColor,number:e.likelyNumber,probability:e.probability,update:k,options:t,resetCard:w},n)))})})]})})}const j=l.default.create({text:{fontSize:20,fontWeight:"bold",marginBottom:10},handContainer:{flexDirection:"row",marginBottom:20},scrollContent:{paddingHorizontal:10}});const k=l.default.create({container:{flex:1,padding:16},settingsContainer:{marginBottom:20},settingRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:10},settingLabel:{fontSize:18,fontWeight:"bold",marginRight:10},numberInputContainer:{flexDirection:"row",alignItems:"center"},numberInput:{height:40,width:50,borderColor:"#ccc",borderWidth:1,borderRadius:4,textAlign:"center",marginHorizontal:5},controlButton:{width:40,height:40,backgroundColor:"#f0f0f0",borderRadius:20,justifyContent:"center",alignItems:"center"},controlText:{fontSize:20,fontWeight:"bold"},mainTitle:{fontSize:32,textAlign:"center",fontWeight:"bold",marginVertical:16},scrollView:{flex:1},scrollContent:{paddingBottom:20},deckContainer:{flexDirection:"row",justifyContent:"space-between",marginBottom:20}});(0,r.default)((function(){const[e,t]=(0,o.useState)(5),[n,r]=(0,o.useState)(5),l=["Red","Green","Blue","Yellow","White"],u={1:3,2:2,3:2,4:2,5:1},f={color:[...l,"?"],number:[...Object.keys(u),"?"]},[m,x]=(0,o.useState)({}),[y,g]=(0,o.useState)({}),[p,j]=(0,o.useState)([]);function w(e,t,n){const r=l.indexOf(e);let o=p[r];o[t]=o[t]+n;let i=[...p];i[r]=o,j(i)}function v(e){if(console.log("Loading deck here"),0==e){let e={};var t=[];for(let n of l){let r=[],o=[];for(let e in u){o.push(u[e]);for(let t=0;t<u[e];t++)r.push(e)}t.push(o),e[n]=r}return console.log(e),j(t),e}{console.log("Loading empty deck");let e={};for(let t of l)e[t]=[];return console.log(e),e}}function S(e,t,n,r,o){console.log(`Moving the ${n} ${r} to the ${o}`);var l=e[n];l=(l=function(e,t){console.log(e);let n=e.indexOf(t);return-1!==n&&e.splice(n,1),e}(l,r)).sort(((e,t)=>e-t));var i=t[n];i.push(r),i=i.sort(((e,t)=>e-t)),"Deck"==o?(w(n,r,1),x(Object.assign({},t,{[n]:i})),g(Object.assign({},e,{[n]:l}))):"Shown"==o&&(w(n,r,1),g(Object.assign({},t,{[n]:i})),x(Object.assign({},e,{[n]:l})))}function B(e,t,n){"Shown"==e?S(y,m,n,t,"Deck"):S(m,y,n,t,"Shown")}return(0,o.useEffect)((()=>{let e=v(!1),t=v(!0);x(e),g(t)}),[n]),(0,o.useEffect)((()=>{let e=v(!1),t=v(!0);x(e),g(t)}),[n]),(0,h.jsxs)(c.default,{style:k.container,children:[(0,h.jsx)(s.default,{style:k.mainTitle,children:"Hanabi"}),(0,h.jsxs)(c.default,{style:k.settingsContainer,children:[(0,h.jsxs)(c.default,{style:k.settingRow,children:[(0,h.jsx)(s.default,{style:k.settingLabel,children:"Players:"}),(0,h.jsxs)(c.default,{style:k.numberInputContainer,children:[(0,h.jsx)(d.default,{onPress:()=>t((e=>Math.max(e-1,2))),style:k.controlButton,children:(0,h.jsx)(s.default,{style:k.controlText,children:"-"})}),(0,h.jsx)(a.default,{style:k.numberInput,keyboardType:"numeric",value:e.toString(),onChangeText:e=>{const n=parseInt(e)||2;t(Math.min(Math.max(n,2),5))}}),(0,h.jsx)(d.default,{onPress:()=>t((e=>Math.min(e+1,5))),style:k.controlButton,children:(0,h.jsx)(s.default,{style:k.controlText,children:"+"})})]})]}),(0,h.jsxs)(c.default,{style:k.settingRow,children:[(0,h.jsx)(s.default,{style:k.settingLabel,children:"Cards per Player:"}),(0,h.jsxs)(c.default,{style:k.numberInputContainer,children:[(0,h.jsx)(d.default,{onPress:()=>r((e=>Math.max(e-1,3))),style:k.controlButton,children:(0,h.jsx)(s.default,{style:k.controlText,children:"-"})}),(0,h.jsx)(a.default,{style:k.numberInput,keyboardType:"numeric",value:n.toString(),onChangeText:t=>{const n=parseInt(t)||4,o=Math.floor(50/e),l=Math.min(o,10),i=Math.min(Math.max(n,4),l);r(i),i===l&&console.warn(`Maximum cards per player reached (${l}) with ${e} players`)}}),(0,h.jsx)(d.default,{onPress:()=>r((e=>Math.min(e+1,5))),style:k.controlButton,children:(0,h.jsx)(s.default,{style:k.controlText,children:"+"})})]})]})]}),(0,h.jsxs)(i.default,{style:k.scrollView,contentContainerStyle:k.scrollContent,showsVerticalScrollIndicator:!1,children:[(0,h.jsxs)(c.default,{style:k.deckContainer,children:[(0,h.jsx)(b,{given_title:"Deck",cards_to_show:m,changeStatus:B}),(0,h.jsx)(b,{given_title:"Shown",cards_to_show:y,changeStatus:B})]}),(0,h.jsx)(C,{deck:m,discard:y,options:f,cards_per_player:n,frequencies:u})]})]})}))}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var l=t[r]={exports:{}};return e[r](l,l.exports,n),l.exports}n.m=e,(()=>{var e=[];n.O=(t,r,o,l)=>{if(!r){var i=1/0;for(d=0;d<e.length;d++){for(var[r,o,l]=e[d],a=!0,s=0;s<r.length;s++)(!1&l||i>=l)&&Object.keys(n.O).every((e=>n.O[e](r[s])))?r.splice(s--,1):(a=!1,l<i&&(i=l));if(a){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[r,o,l]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,l,[i,a,s]=r,c=0;if(i.some((t=>0!==e[t]))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(s)var d=s(n)}for(t&&t(r);c<i.length;c++)l=i[c],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(d)},r=self.webpackChunkweb=self.webpackChunkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,[80],(()=>n(3415)));r=n.O(r)})();
//# sourceMappingURL=main.ba6838fc.js.map